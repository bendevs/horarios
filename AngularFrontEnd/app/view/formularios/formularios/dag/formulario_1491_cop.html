<style type="text/css">
/*img {
  filter: gray;
  -webkit-filter: grayscale(1);
    -webkit-box-shadow: 0px 2px 6px 2px rgba(0,0,0,0.75);
    -moz-box-shadow: 0px 2px 6px 2px rgba(0,0,0,0.75);
    box-shadow: 0px 2px 6px 2px rgba(0,0,0,0.75);
    margin-bottom:20px;
}

img:hover {
  filter: none;
  -webkit-filter: grayscale(0);

}*/


input[name="slider-select-element"] {
    display: none;
}

#slider-arrows {
    margin: -10% auto 0 auto;
    width: 90%;
}

#slider-box {
    height: 100%;
    width: 300%;
}

#slider-container {
    height: 20%;
    margin: 0 auto;
    overflow: hidden;
    text-align: left;
    width: 80%;
}

.element{
    min-height: 300px;
    max-height: 300px;
    width: 100%;
}

.element-blue {
    background: blue;
}

.element-green {
    background: green;
}

.element-red {
    background: red;
}

.slider-element {
    float: left;
    width: 33.333%;
}

#element1:checked ~ #slider-arrows label:nth-child(2),
#element2:checked ~ #slider-arrows label:nth-child(3),
#element3:checked ~ #slider-arrows label:nth-child(1) {
    display: block;
    float: right;
}

#element1:checked ~ #slider-arrows label:nth-child(3),
#element2:checked ~ #slider-arrows label:nth-child(1),
#element3:checked ~ #slider-arrows label:nth-child(2) {
    display: block;
    float: left;
}

#element1:checked ~ #slider-arrows label:nth-child(2):before,
#element2:checked ~ #slider-arrows label:nth-child(3):before,
#element3:checked ~ #slider-arrows label:nth-child(1):before {
    color: black;
    content: "\f054";
    font-family: FontAwesome;
    font-style: normal;
    font-weight: normal;
    line-height: 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: antialiased;
}

#element1:checked ~ #slider-arrows label:nth-child(3):before,
#element3:checked ~ #slider-arrows label:nth-child(2):before,
#element2:checked ~ #slider-arrows label:nth-child(1):before {
    color: black;
    content: "\f053";
    font-family: FontAwesome;
    font-style: normal;
    font-weight: normal;
    line-height: 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: antialiased;
}

#element1:checked ~ #slider-container #slider-box {
    margin-left: 0;
}

#element2:checked ~ #slider-container #slider-box {
    margin-left: -100%;
}

#element3:checked ~ #slider-container #slider-box {
    margin-left: -200%;
}
#element4:checked ~ #slider-container #slider-box {
    margin-left: -300%;
}

#slider-arrows label {
    color: transparent;
    cursor: pointer;
    display: none;
    font-size: 2rem;
    height: 20px;
    width: 20px;
}

#slider-box {
    -webkit-transition: all 0.75s ease;
    -moz-transition: all 0.75s ease;
    -ms-transition: all 0.75s ease;
    -o-transition: all 0.75s ease;
    transition: all 0.75s ease;
}
</style>
<script type="text/javascript">
    function adquisisionController($scope, $timeout, $route, $rootScope, $routeParams, $location, $http, Data, sessionService, CONFIG, LogGuardarInfo, DreamFactory, ngTableParams, $filter, sessionService, $filter, sweet, $sce, registroLog,FileUploader,fileUpload,wsContribuyenteNatural,wsLicencia, $window) {
        var aRegistro = {"valor": "","campo": "","activo":"","tarea_caracterist2":"","responsable":""};
        $scope.caracteristica = aRegistro;
        $scope.item = [];
        $scope.ListFuncionarios = "";
        $scope.selectedRow = null;
        $scope.datos.obtAsignaciones = [];
        var fecha = new Date();
        $scope.anio_actual = fecha.getFullYear(); 
        $scope.btnmostrar2 = "false";
        if ($scope.datos.gen) {
          if ($scope.datos.gen == "SI") {
            $scope.btnmostrar = "false";
          }else{
            $scope.btnmostrar = "true";
          }
        }else{
            $scope.btnmostrar = "true";
        }
        //$scope.datos.UBM_ARCHIVO_DAG = 3019;
        $scope.mostar = "false"
        $scope.tecnicoesp = function(valor){
            console.log("valor ----->",valor);
            if (valor == 1) {
              $scope.mostar = "true"
            }else{
              $scope.mostar = "false"
            }
        }
          $scope.description_act = function(act){
              var sector = new renderData();
                sector.sql = "select dag_ubm_activo_descripcion from  dag.dag_ubm_activos where dag_ubm_activo_codigoaf = '"+act+"' ";
                sector.renderSqlDinamic(function(resultado){
                  resultadoApi = JSON.parse(resultado);
                  var result = resultadoApi.success.data[0];
                  //$scope.datos.UBM_REP_CARACTERISTICAS_ACTIVO = JSON.stringify(result.sp_reporte_dinamico123);
                  $scope.datos.UBM_REP_CARACTERISTICAS_ACTIVO = result.sp_reporte_dinamico123[0].dag_ubm_activo_descripcion;
                  $scope.carac = result.sp_reporte_dinamico123[0].dag_ubm_activo_descripcion;
                  console.log("resp loc ",result.sp_reporte_dinamico123[0].dag_ubm_activo_descripcion);
                    angular.forEach(result.sp_reporte_dinamico123[0].dag_ubm_activo_descripcion,function(val, index){
                      console.log("index",index);
                      console.log("val",val);
                      
                    });
                });
          }
          $scope.getSector = function(){          
            

              var sector = new renderData();
              sector.sql = "select * from dag.dag_dag_sectores  where dag_s_gestion =  '"+$scope.anio_actual+"'  and dag_s_estado='A' ";
              sector.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                var result = resultadoApi.success.data[0];
                $scope.datosSector = result.sp_reporte_dinamico123;                
              });
          };

          $scope.getDA2 = function(){
            var dada = new renderData();
              dada.sql = "select * from dag.dag_dag_direccion_administrativa  where dag_da_gestion =  '"+$scope.anio_actual+"' and dag_da_estado LIKE 'A'";
              dada.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                var result = resultadoApi.success.data[0];
                $scope.datosDirAdm = result.sp_reporte_dinamico123;                
              });              
          };

          $scope.getUE2 = function(){
            var ueue = new renderData();
              ueue.sql = "select * from dag.dag_dag_unidad_ejecutora  where dag_ue_gestion =  '"+$scope.anio_actual+"' and dag_ue_estado LIKE 'A'";
              ueue.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                var result = resultadoApi.success.data[0];
                $scope.datosUniEje = result.sp_reporte_dinamico123;                
              });
          };
  
          $scope.getUO2= function(){
            var uouo = new renderData();
              uouo.sql = "select * from dag.dag_dag_unidad_organizacional  where dag_uo_gestion =  '"+$scope.anio_actual+"' and dag_uo_estado LIKE 'A'";
              uouo.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                var result = resultadoApi.success.data[0];
                $scope.datosUniOrg = result.sp_reporte_dinamico123;                
              });
          };

          /////////////////// dependientes //////////////////
          $scope.getDA = function(sector){
            var dada = new renderData();
              dada.sql = "select * from dag.dag_dag_direccion_administrativa  where dag_da_gestion =  '"+$scope.anio_actual+"' and dag_da_estado LIKE 'A' and dag_da_s = '"+sector+"' ";
              dada.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                var result = resultadoApi.success.data[0];
                $scope.datosDirAdm = result.sp_reporte_dinamico123;                
              });              
          };

          $scope.getUE = function(DA){
            var ueue = new renderData();
              ueue.sql = "select * from dag.dag_dag_unidad_ejecutora  where dag_ue_gestion =  '"+$scope.anio_actual+"' and dag_ue_estado LIKE 'A' and dag_ue_da = '"+DA+"' ";
              ueue.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                console.log("aaaaaaaaaaaa------>",resultadoApi);
                console.log("rrrrr ------>",resultadoApi.success.data[0]);
                var result = resultadoApi.success.data[0];
                console.log("lllllllll------>",result.sp_reporte_dinamico123);
                $scope.datosUniEje = result.sp_reporte_dinamico123;                
              });
          };
  
          $scope.getUO = function(UE){
            var uouo = new renderData();
              uouo.sql = "select * from dag.dag_dag_unidad_organizacional  where dag_uo_gestion =  '"+$scope.anio_actual+"' and dag_uo_estado LIKE 'A' and dag_uo_ue = '"+UE+"' ";
              uouo.renderSqlDinamic(function(resultado){
                resultadoApi = JSON.parse(resultado);
                console.log("aaaaaaaaaaaa------>",resultadoApi);
                console.log("rrrrr ------>",resultadoApi.success.data[0]);
                var result = resultadoApi.success.data[0];
                console.log("lllllllll------>",result.sp_reporte_dinamico123);
                $scope.datosUniOrg = result.sp_reporte_dinamico123;
                $scope.UO_Sel="0";
              });
          };

        $scope.funcionarios_resp = function(f_resp){
          console.log("------>",f_resp);
            //$.blockUI();
            var funcionarios = {
              "procedure_name":"ejecutartojson",
              "body":{
                "params": [
                {
                  "name":"expression",

                  "param_type":"IN","value":"select dag_ubm_fr_ci , (dag_ubm_fr_paterno,dag_ubm_fr_materno,dag_ubm_fr_nombres) as nombre from dag.dag_ubm_funcionarioreponsable where dag_ubm_fr_paterno LIKE  '%"+f_resp+"%'"
                }]
              }
            };
            var obj=DreamFactory.api[CONFIG.SERVICE].callStoredProcWithParams(funcionarios);
            obj.success(function(response){
              $scope.funcionarioc = JSON.parse(response[0].ejecutartojson);
              console.log("datos",$scope.funcionarioc);

            })
            obj.error(function(error) {
                $scope.errors["error_usuario"] = error;
            });
        };
        $scope.activos_asig = function(dato){
            var resPartida = {
                "function_name":"dag.sp_dag_ubm_activo_x_funcionario",
                "body":{
                    "params": [
                        {
                            "name": "ci",
                            "value": dato
                        }
                    ]
                }
            };
            DreamFactory.api[CONFIG.SERVICE].callStoredFuncWithParams(resPartida).success(function (response){
              //$scope.response2 = JSON.parse(response);
              $scope.response2 = response;
              console.log(response);
            }).error(function(error) {
                $scope.errors["error_rol"] = error;
            });
        }

        var fecha = new Date();
        $scope.fechactual = fecha.getFullYear() + "-" + fecha.getMonth() + "-" + fecha.getDate() + " " + fecha.getHours() + ":" + fecha.getMinutes() + ":" + fecha.getSeconds();
        $scope.model = {
          startDate: new Date('09/21/2015'),
          endDate: new Date()
        };

        $scope.startDateOpen = function($event) {
               $event.preventDefault();
               $event.stopPropagation();
               $scope.startDateOpened = true;
        };

        $scope.guardarItem = function (){
                $scope.cargarDatos($scope.datos);
                $scope.guardarData($scope.datos);

        }

        $scope.derivacion = function(valor) {
          $scope.datos.g_UO_solicitante	= $scope.datos.UBM_NODO_UAF;
        }

        $scope.verificarDatos = function(datos){
             swal({
              title: "Generar Codigo",
              text: "Esta seguro de generar codigo",
              type: "warning",
              showCancelButton: true,
              confirmButtonColor: "#DD6B55",
              confirmButtonText: "OK",
              closeOnConfirm: false},
              function(){
              $scope.generar_codigo(datos);
              $scope.datos.gen = "SI";
              swal("Generando...!");
            });
        }
        $scope.generar_codigo = function(datos){

         

          /*if(parseInt(datos.UBM_VER_CORRECTA) == 2){
            $scope.cargarDatos($scope.datos);
            $scope.guardarData($scope.datos);
          }
          else{*/


            var codigo = parseInt(sessionStorage.IDUSUARIO);
            console.log("codigo",parseInt(codigo));
            var c = JSON.stringify(datos);
            console.log("datos",c);
            var x = datos.tarea_caracterist;
            console.log("json",x);
            var resPartida = {
                  "procedure_name":"dag.dag_generar_codigo_ubm",
                  "body":{
                      "params": [
                          {
                              "name": "uo_valor",
                              "value": datos.UO_Sel
                          },
                          {
                              "name": "da_valor",
                              "value": datos.DA_Sel
                          },
                          {
                              "name": "sector_valor",
                              "value": datos.Sec_Sel
                          },
                          {
                              "name": "ue_valor",
                              "value": datos.UE_Sel
                          },
                          {
                              "name": "caracteristicas",
                              "value": datos.tarea_caracterist
                          },
                          {
                              "name": "fecha_incorporacion",
                              "value": datos.g_fecha
                          },
                          {
                              "name": "ci_resp",
                              "value": datos.UBM_REP_CI_CIU
                          },
                          {
                              "name": "ci_tec",
                              "value": datos.UBM_FUNCIONARIO_SELECCIONADO
                          }

                      ]
                  }
              };
              DreamFactory.api[CONFIG.SERVICE].callStoredProcWithParams(resPartida).success(function (response){
                swal("Generado");
                /*console.log("******************",response[1].form);
                $scope.datos.UBM_FORM = response[1].form;
                console.log("******************",$scope.datos);
                $.unblockUI();*/
                
              }).error(function(error) {
                  $scope.errors["error_rol"] = error;
                  console.log("errorrrrrr");
              });
          //}

          /*$scope.cargarDatos($scope.datos);
          $scope.guardarData($scope.datos);*/
        }

        $scope.comb = function(){
            var resPartida = {
                "function_name":"dag.sp_partida"
            };

            DreamFactory.api[CONFIG.SERVICE].callStoredFuncWithParams(resPartida).success(function (response){
              $scope.combop = response;
              $.unblockUI();
            }).error(function(error) {
                $scope.errors["error_rol"] = error;
            });
        }
        $scope.caracteristicass = function(dato){
            var resPartida = {
                "function_name":"dag.sp_caracteristicas",
                "body":{
                    "params": [
                        {
                            "name": "codigo",
                            "value": dato
                        }
                    ]
                }
            };
            DreamFactory.api[CONFIG.SERVICE].callStoredFuncWithParams(resPartida).success(function (response){
              $scope.data = response;
              $.unblockUI();
            }).error(function(error) {
                $scope.errors["error_rol"] = error;
            });
        }
        $scope.descripcion = function(dato){
          $scope.mostrar = "ok";
            var resPartida = {
                "function_name":"dag.sp_dag_caracteristicas",
                "body":{
                    "params": [
                        {
                            "name": "id_car",
                            "value": dato
                        }
                    ]
                }

            };
            DreamFactory.api[CONFIG.SERVICE].callStoredFuncWithParams(resPartida).success(function (response){
                if (response !='[]') {
                  var DetItem="";
                  DetItem = response;
                  $scope.caracteristicas1 = JSON.parse(DetItem[0].sp_dag_caracteristicas);
                  var size = Object.keys($scope.caracteristicas1).length;
                      $scope.caracteristicas = [];
                      for(var j=0; j<size; j++){
                          $scope.caracteristicas.push({
                              name: $scope.caracteristicas1[j],
                              value: $scope.caracteristicas1[j]
                          });
                      }
                }
              $.unblockUI();
              }).error(function(error) {
                  $scope.errors["error_rol"] = error;
              });
        }
        $scope.Cargarfuncionarios = function () {
            var datosFuncionarios = {
                "procedure_name":"dag.sp_dag_ubm_funcionarioreponsable",
            };
            DreamFactory.api[CONFIG.SERVICE].callStoredProcWithParams(datosFuncionarios).success(function (response){
                var tmpListFuncionarios = JSON.stringify(response);
                $scope.ListFuncionarios = JSON.parse(tmpListFuncionarios);
            })
            .error(function(data){
                sweet.show('', 'Error al cargar la informacion del item: ', 'error');
            });
        }
      $scope.mostrarVector = function (dato){
        console.log(dato);
        console.log("este es el dato==>",dato[1]);
        console.log("este es el dato==>",dato[2]);
        console.log("este es el dato==>",dato[3]);
      }

        $scope.probarCodificacion = function () {
          var dat2 = document.getElementById("tarea_caracterist").value;
         console.log("este es el tarea_caracterist",dat2);
         var dattoo = JSON.parse(dat2);
         console.log("aqui esta el parseado",dattoo);
         var indice = 1;
          setTimeout(function(){
             for(var i=1; i<= dattoo.length-1;i++){

            var codificacion = {
                "procedure_name":"dag.sp_dag_codificacion2",
                "body":{
                    "params": [
                        {
                            "name": "activo1",
                            "value": dattoo[i].activo
                        },
                        {
                          "name": "cantidad",
                            "value": dattoo[i].cantidad
                        }
                    ]
                }
            };
            DreamFactory.api[CONFIG.SERVICE].callStoredProcWithParams(codificacion).success(function (response){
                console.log("estaaaaaaaaaaaa es la codificacion==>",response);
                console.log("aqui esta el vector==>",response[0].sp_dag_codificacion2);

                x = response[0].sp_dag_codificacion2;
                 if(indice > 0){
                  console.log("aqui la codificacion",dattoo[indice].codificacion);
                  dattoo[indice].codificacion = response[0].sp_dag_codificacion2;
                   $scope.codificacion3(dattoo,indice);
                  indice = indice + 1;
                  console.log(dattoo);

                 }
            })
            .error(function(data){
                sweet.show('', 'Error al cargar la informacion del item: ', 'error');
            });
         }
        console.log("aqui esta el parseado con los datosssssssss",dattoo);
          },5000);
        };

        $scope.codificacion3 = function(dattoo,id){
          alert(343);
          var x =[];
          var x = dattoo[id].codificacion;
            x = x.split(' ');
            console.log("esto es lo que quiero",x);
            console.log(x[0]);
            console.log(x[1]);
             if(angular.equals(x[0],x[1]))
              {
              dattoo[id].codificacion=x[1];
              }
              else
              {
                dattoo[id].codificacion = '['+x[0]+'-'+x[1]+']';
              }


           var c = 1;
           x=0;
           obj=[];
           angular.forEach(dattoo,function(val, index){
              if (c==1) {
                c = c+1;

              }else{
                obj[x]=val;

                x=x+1;

              }
           });
           $scope.items1 = obj;
          }

        $scope.cerear = function () {
          $scope.datos.obtAsignaciones[$scope.selectedRow].dag_ubm_asig_funcionario_responsable = $scope.tmprowfunc;
        }
        $scope.cambiafuncionario = function(funcionario,ap_pat,ap_mat,nomb){
            $scope.caracteristica.responsable = funcionario + ' ' + ap_pat + ' ' + ap_mat + ', ' + nomb;
            //$scope.datos.obtAsignaciones[$scope.selectedRow].dag_ubm_asig_funcionario_responsable = funcionario + ' ' + ap_pat + ' ' + ap_mat + ', ' + nomb;
            //$scope.datos.obtAsignaciones[$scope.selectedRow].dag_ubm_asig_cod_funcionario_responsable = funcionario;
        }
        $scope.guardargrid = function(dato){
          $scope.pushItem();
          $scope.datos0 = JSON.stringify(dato);
           var data = document.getElementById("tarea_caracterist").value;
           JSON.parse(data);
           var data2 = JSON.parse(data);
           var id = data2.length+1;
            addRowJson($scope.datos0,"tarea_caracterist");
           var dat2 = document.getElementById("tarea_caracterist").value;
           $scope.datos.tarea_caracterist = dat2;
           datoo2 = JSON.parse(dat2);
           var c = 1;
           x=0;
           obj=[];
           angular.forEach(datoo2,function(val, index){
              if (c==1) {
                c = c+1;

              }else{

                obj[x]=val;
                x=x+1;

              }

           });

          $scope.items1 = obj;
          $scope.cargar();

        }



        $scope.idd = function(id){
          $scope.Cargarfuncionarios();

          $scope.modal="upd";

          id = id;
          $scope.id = id;

          var dat25 = $scope.datos.tarea_caracterist;
          $scope.recuperar = JSON.parse(dat25);
          for(var i=0;i<$scope.recuperar.length;i++){
              if(i==id){
                $scope.caracteristicass($scope.recuperar[i].campo);
                $scope.descripcion($scope.recuperar[i].activo);
              }
          }
          for(var i=0;i<$scope.recuperar.length;i++){
              if(i==id){
                $scope.caracteristica.valor = $scope.recuperar[i].valor;
                $scope.caracteristica.campo = $scope.recuperar[i].campo;
                $scope.caracteristica.activo = $scope.recuperar[i].activo;
                $scope.caracteristica.cantidad = $scope.recuperar[i].cantidad;
                $scope.caracteristica.codificacion = $scope.recuperar[i].codificacion;
                $scope.caracteristica.tarea_caracterist2 = $scope.recuperar[i].tarea_caracterist2;
                $scope.caracteristica.responsable = $scope.recuperar[i].responsable;
                $scope.complet = $scope.recuperar[i].tarea_caracterist2;
                $scope.datos.ARCHIVOS_MULTIPLES = $scope.recuperar[i].tarea_adjuntos;


                $scope.complet = $scope.recuperar[i].tarea_caracterist2;
                $scope.caracteristica.tarea_adjuntos = $scope.recuperar[i].tarea_adjuntos;
                $scope.datos.ARCHIVOS_MULTIPLES = $scope.recuperar[i].tarea_adjuntos;
              }
          }
          $scope.comborec();
        }
        $scope.comborec = function(){
            setTimeout(function () {
                $scope.$apply(function () {
                  var id = $scope.id;
                  var dat25 = $scope.datos.tarea_caracterist;
                  $scope.recuperar = JSON.parse(dat25);
                  for(var i=0;i<$scope.recuperar.length;i++){
                      if(i==id){
                        document.getElementById("campo").value = $scope.recuperar[i].campo;
                        document.getElementById("activo").value = $scope.recuperar[i].activo;
                      }
                  }
                  $scope.caracteristicas1 = $scope.complet[0].value;
                  var size = $scope.complet.length;
                  $scope.caracteristicas = [];
                  for(var j=0; j<size; j++){
                      $scope.caracteristicas.push({
                          name: $scope.complet[j].name,
                          value: $scope.complet[j].value
                      });
                  }
                });
            }, 2000);
        }
        $scope.editargrid = function(da){
          $scope.pushItem();
          updRowJson(da,"tarea_caracterist",$scope.id);
           var dat2 = document.getElementById("tarea_caracterist").value;
           $scope.datos.tarea_caracterist = dat2;
           datoo2 = JSON.parse(dat2);
           var c = 1;
           x=0;
           obj=[];
           angular.forEach(datoo2,function(val, index){
              if (c==1) {
                c = c+1;

              }else{
                obj[x]=val;

                x=x+1;

              }
           });
           $scope.items1 = obj;
          $scope.cargar();
        }
        $scope.del = function (id) {
          $scope.mostrar = "ok";
          Eliminar(id,"tarea_caracterist");
          var dat2 = document.getElementById("tarea_caracterist").value;
          datoo2 = JSON.parse(dat2);
           var c = 1;
           x=0;
           obj=[];
           angular.forEach(datoo2,function(val, index){
              if (c==1) {
                c = c+1;

              }else{
                obj[x]=val;

                x=x+1;

              }
           });
           $scope.items1 = obj;
           $scope.cargar();

        }

        $scope.pushItem1 = function (){

          $scope.caracteristica.tarea_adjuntos = $scope.datos.ARCHIVOS_MULTIPLES;
        }
        $scope.pushItem = function () {
          var size = Object.keys($scope.caracteristicas).length;
          var nodo_carac = Array();
          var nodo_carac1 = Array();
            nodo_carac = "";
            nodo_carac1 = '{';
            for(var j=0; j<size; j++){
              nodo_carac = nodo_carac + ' ' + $scope.caracteristicas[j].name + ': ' + $scope.caracteristicas[j].value;
              if (j<size-1) {
                nodo_carac = nodo_carac + ',';
              }
              nodo_carac1 = nodo_carac1 + ',' + JSON.stringify($scope.caracteristicas[j].name) + ':' + JSON.stringify($scope.caracteristicas[j].value);
            }
            nodo_carac1 = nodo_carac1 + '}';
            $scope.item.push({
              caracteristicas: nodo_carac
            });
           $scope.caracteristica.tarea_caracterist2 = $scope.caracteristicas;
        }
        $scope.cargar = function(){
          if ($scope.datos.tarea_caracterist) {
          var ordenar = JSON.parse($scope.datos.tarea_caracterist);


          for (var i = 1; i < ordenar.length; i++) {
            if (ordenar.length>0) {
                var incc = 0;
                  console.log("el contador",ordenar.length);
                  for (var k = 1; k < ordenar.length; k++) {
                     incc = incc+1;
                     ordenar[k].id = incc;
                     console.log("este es el id",ordenar[k].id);
                  }
              }
          }
          console.log("nueva cadena ",ordenar);
          var dat2 = ordenar;
          datoo2 = ordenar;
          $scope.cart = datoo2[1].tarea_caracterist2;
           var c = 1;
           x=0;
           obj=[];
           angular.forEach(datoo2,function(val, index){
            if (c==1) {
              c = c+1;

            }else{
              obj[x]=val;

              x=x+1;

            }
           });

           $scope.items1 = obj;

           console.log("respuesta 0",obj);
          $scope.obtUsuarios = obj;
          console.log("respuesta 1",$scope.obtUsuarios);
            var data = obj;
            console.log("respuesta 2",data);
            $scope.tablaUsuarios = new ngTableParams({
                page: 1,
                count: 10,
                filter: {},
                sorting: {}
            }, {
                total: $scope.obtUsuarios.length,
                getData: function($defer, params) {
                    var filteredData = params.filter() ?
                    $filter('filter')($scope.obtUsuarios, params.filter()) :
                    $scope.obtUsuarios;
                    var orderedData = params.sorting() ?
                    $filter('orderBy')(filteredData, params.orderBy()) :
                    $scope.obtUsuarios;
                    params.total(orderedData.length);
                    $defer.resolve(orderedData.slice((params.page() - 1) * params.count(), params.page() * params.count()));
                  }
            });
          }

        }
        $scope.limpiarFormRegistro = function(){
          document.getElementById("tarea_caracterist2").value = "[]";
          $scope.caracteristica.tarea_caracterist2 = "[]";
          $scope.mostrar = "no";
          $scope.boton="new";
          $scope.Cargarfuncionarios();
          $scope.caracteristica = "";
          $scope.datos.ARCHIVOS_MULTIPLES = "";
        }
        $scope.inciarUpload =   function(){
        try{
          $('#multiDocsButon').click(function(){
                $('#multiDocsFile').click();
          });
        }catch(e){}
    };

    var idCiu = sessionService.get('IDCIUDADANO');
    $scope.uploader = new FileUploader({
        url: CONFIG.APIURL + "?desripcion=ciudadano&&idCiudadano=" + idCiu
    });

    var uploader = $scope.uploader;

    uploader.filters.push({
        name: 'customFilter',
        fn: function(item , options) {
            console.log("0");
            return this.queue.length < 10;
        }
    });

    uploader.onWhenAddingFileFailed = function(item /*{File|FileLikeObject}*/, filter, options) {
    };

    uploader.onAfterAddingFile = function(fileItem) {
        tipoDocumento = fileItem.file.type;
        var nameArray = tipoDocumento.split('/');
        tipoDocumento = nameArray[1];
        var count = 0;

        if(tipoDocumento == "png" || tipoDocumento == "jpg" || tipoDocumento == "jpeg" || tipoDocumento == "txt" || tipoDocumento == "plain" || tipoDocumento == "zip" || tipoDocumento == "rar" || tipoDocumento == "vnd.ms-word.document.12" || tipoDocumento == "vnd.openxmlformats-officedocument.spreadsheetml.sheet" || tipoDocumento == "vnd.visio" || tipoDocumento == "vnd.ms-publisher" || tipoDocumento == "msaccess" || tipoDocumento == "vnd.openxmlformats-officedocument.wordprocessingml.document"){
            $scope.botonSubirOriginal = null;
            $scope.botonSubirError = "oculta";
        }
        else{
            $scope.botonSubirError = null;
            $scope.botonSubirOriginal = "oculta";
        }
    };

    $scope.falla = function()
    {
        sweet.show('', "Tipo de archivo incorrecto elimine porfavor", 'error');
        $scope.desabilitado2 = true;
    }

    $scope.almacenarDocumentos = function(aFiles){
        var sDirTramite = $rootScope.tramiteId;
        $scope.direccionvirtual = "RC_CLI";
        var uploadUrl = CONFIG.APIURL + "/files/" + $scope.direccionvirtual + "/" + sDirTramite + "/";
        angular.forEach(aFiles, function(archivo, key) {
            if(typeof(archivo) != 'undefined'){
                var urlIdcos = CONFIG.APIURL + "/files/" + $scope.direccionvirtual + "/" + sDirTramite + "/" + archivo.name + "?app_name=todoangular";
                fileUpload.uploadFileToUrl(archivo, uploadUrl);
                $scope.almacenarGDocumental(archivo, urlIdcos);
            }else{
                console.log("error en el archivo");
            }
        });
    };
    $scope.almacenarGDocumental = function(dataArchivo, sUrl){
        var valores = "";
        var cadena = "";
        var nombreFile = dataArchivo.name;
        var subirU = {};
        subirU['doc_sistema'] = 'RC_CLI';
        subirU['doc_proceso'] = 'ADJUNTO';
        subirU['doc_ci_nodo'] = 'DMS';
        subirU['doc_datos'] = valores;
        subirU['doc_version'] ='1';
        subirU['doc_tiempo'] = '0';
        subirU['doc_firma_digital'] = 0;
        subirU['doc_acceso'] = "";
        subirU['doc_tipo_documento'] = "pdf";
        subirU['doc_tamanio_documento'] = "0";
        subirU['doc_tps_doc_id'] = '1';//data.vtps_doc_id
        subirU['doc_tipo_documentacion'] = 'U';
        subirU['doc_tipo_ingreso'] = 'I';
        subirU['doc_estado_de_envio'] = 'N';
        subirU['doc_correlativo'] = '';
        subirU['doc_tipo_documento_ext'] = '';
        subirU['doc_nrotramite_nexo'] = '';
        subirU['doc_id_carpeta'] = '';
        subirU['doc_usuario'] = sessionService.get('USUARIO');
        subirU['doc_estado'] = 'A';
        subirU['doc_url'] = sUrl;
        subirU['doc_url_logica'] = cadena;
        subirU['doc_nombre'] = nombreFile;
        var ressubirU = {
            table_name:"dms_gt_documentos",
            body:subirU
        };
    };

    $scope.adicionarimagenes = function(datos){
          console.log("aqui estan las fotos==>>",datos);

    }

    var archivoUpload = "";

    uploader.onSuccessItem = function(fileItem, response, status, headers) {
        //FORMANDO LA URL - ARCHIVO
        $scope.direccionvirtual = "RC_CLI";
        var urlIdcos = CONFIG.APIURL + "/files/" + $scope.direccionvirtual + "/" + $rootScope.tramiteId + "/" + fileItem._file.name + "?app_name=todoangular";
        var fileName = fileItem._file.name;

        var fileSize = (((fileItem._file.size)/1024)/1024);
        fileSize = fileSize.toFixed(2);
        if($scope.datos.ARCHIVOS_MULTIPLES){
            aDocAdjuntos = $scope.datos.ARCHIVOS_MULTIPLES;
        }else{
            aDocAdjuntos    =   new Array();
        }

        var datosAdjuntos = {
            "nombre_archivo" : fileName,
            "tam_archivo" : fileSize,
            "estado_archivo" : "Env.",
            "opcion_archivo" : "-",
            "url_archivo" : urlIdcos
        };
        aDocAdjuntos.push(datosAdjuntos);
        $scope.adjuntosArray = aDocAdjuntos;
        var aFile = new Array();
        aFile.push(fileItem._file);
        $scope.almacenarDocumentos(aFile);
        fileItem.remove();
        $scope.datos.ARCHIVOS_MULTIPLES = aDocAdjuntos;
        $rootScope.$broadcast('inicializarFechaOblitatorio', $scope.datos);
    };

    var clsValidarBtn = $rootScope.$on('validarBtn', function(event, data){
        if(data.frm_tra_id){
            $scope.tramitesCiudadano();
        }
    });
    $scope.$on('$destroy', function() {
        clsValidarBtn();
                  $scope.responsables();

    });

    $scope.eliminarMultipleAdjunto = function(sIndex){
        if($scope.datos.ARCHIVOS_MULTIPLES){
            $scope.adjuntosArray = $scope.datos.ARCHIVOS_MULTIPLES;
        }
        if($scope.adjuntosArray){
            $scope.adjuntosArray.splice(sIndex, 1);
        }
        $rootScope.$broadcast('inicializarFechaOblitatorio', $scope.datos);
    };

        $scope.fotos = function (id) {

          console.log("aqui va id=>",id);
          var fot = $scope.datos.tarea_caracterist;
          $scope.mostrarfotos = JSON.parse(fot);
          console.log("aDocAdjuntos",$scope.mostrarfotos[id].tarea_adjuntos);
         // console.log($scope.mostrarfotos[id].tarea_adjuntos);
          if ($scope.mostrarfotos[id].tarea_adjuntos) {

            $scope.modal="new";
          }else{


             setTimeout(function(){
               sweet.show('', "No existe Imagenes", 'error');
                $scope.modal="upd";
               $.unblockUI();
             },1000);

            $scope.$apply();
          }
          $scope.verfotos = $scope.mostrarfotos[id].tarea_adjuntos;

        }
        $scope.$on('api:ready',function(){
          $scope.cargar();
          $scope.comb();
          $scope.Cargarfuncionarios();
          $scope.inciarUpload();
          $scope.getSector();
          $scope.getDA2();
          $scope.getUE2();
          $scope.getUO2();
          $scope.activos_asig();
        });
        $scope.inicioadquisision = function () {
          $scope.responsables();
          $scope.comb();
          $scope.cargar();
          $scope.inciarUpload();
          $scope.Cargarfuncionarios();
          $scope.getSector();
          $scope.getDA2();
          $scope.getUE2();
          $scope.getUO2();
          $scope.activos_asig();
          if (!$scope.datos.tarea_caracterist)
            $scope.datos.tarea_caracterist = '[{"tipo":"GRD","titulos":"Partida|Tipo de Activo|Caracteristicas|Valor|Responsable de Activo","campos":"activo|campo|responsable|valor|valor","impresiones":"true|true|true|true|true"}]';
        };
        function Eliminar(id,campo) {
            dat = JSON.parse(document.getElementById(campo).value);
            delete dat[id];
            var nuevosDatos=[];
            nuevosDatos = JSON.stringify(dat);
            nuevosDatos=nuevosDatos.replace("null,","");
            nuevosDatos=nuevosDatos.replace(",null","");
            nuevosDatos=nuevosDatos.replace("null","");
            document.getElementById(campo).value = nuevosDatos;
            $scope.datos.tarea_caracterist = nuevosDatos;
        }

        function updRowJson(fila, campo,id){
            datos = JSON.parse(document.getElementById(campo).value);
            var nuevosDatos=[];
            var snuevosDatos="";
            cont=0;
            for(var i=0;i<datos.length;i++){
                if(i==id) nuevosDatos.push(fila);
                else        nuevosDatos.push(datos[i]);
                cont++;
            }
            snuevosDatos = JSON.stringify(nuevosDatos,null);
            document.getElementById(campo).value = snuevosDatos;
            $scope.datos.tarea_caracterist = snuevosDatos;
        }

          $scope.responsables = function (){
         var datosFuncionarios = {
                "procedure_name":"dag.sp_dag_responsables",
            };
            DreamFactory.api[CONFIG.SERVICE].callStoredProcWithParams(datosFuncionarios).success(function (response){
                console.log(response);
                $scope.responsables = response;
            })
            .error(function(data){
                sweet.show('', 'Error al cargar la informacion del item: ', 'error');
            });
        };

         function adicionarConficacion(fila, campo,id){
            console.log("campo==>",campo);
            console.log("fila",fila);
            console.log("id",id);
        }


    }
/////////////////////////////////////////////////////////////////////////////////////////////////////////
    function addRowJson(fila, campo){
        nuevaFila= JSON.parse(fila);
        datos = JSON.parse(document.getElementById(campo).value);
        datos.push(nuevaFila);
        var nuevosDatos=[];
        nuevosDatos = JSON.stringify(datos,null);
        document.getElementById(campo).value = nuevosDatos;
    }
    function showContent() {
        element = document.getElementById("content0");
        check = document.getElementById("verificacion");
        if (check.checked) {
            element.style.display='block';
        }
        else {
            element.style.display='none';
        }
    }

</script>

<div ng-controller="adquisisionController" data-ng-init="inicioadquisision()">
<!-- begin form -->
    <form class="form-horizontal" name="formulario" novalidate>
        <div div class="wrap" >

            <div class="ibox-title_2" id="div_UBM_REP_T_FORM_REPOSICION">
              <h5>FORMULARIO DE REPOSICION:</h5>
            </div>
            <div id="div_g_fecha" name="componentes">
              <div class="form-group"><label class="col-sm-2 control-label">Fecha de Reposición:</label>
                <div class="col-sm-10">
                  <input type="text" placeholder="Fecha de Reposición" class="form-control" id="g_fecha" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.g_fecha" readonly="readonly">
                </div>
              </div>
            </div>
            <div class="ibox-title_2" id="div_UBM_REP_TIT">
              <h5>Datos del Repositor:</h5>
            </div>
            <div id="div_UBM_REP_REPOSITOR" name="componentes">
              <div class="form-group"><label class="col-sm-2 control-label">El Repositor es:</label>
                <div class="col-sm-10">
                  <select onchange="f_obtener_texto('UBM_REP_REPOSITOR');tipo = f_obtener_valor('UBM_REP_REPOSITOR');if(tipo=='1'){f_muestra_div('div_UBM_FUN_CI');f_oculta_div('div_UBM_REP_CI_CIU');f_oculta_div('div_UBM_REP_PAT_CIU');f_oculta_div('div_UBM_REP_MAT_CIU');f_oculta_div('div_UBM_REP_NOM_CIU');f_oculta_div('div_UBM_EMP_ASEG');f_oculta_div('div_UBM_REP_EXP_CIU');f_oculta_div('div_UBM_REP_PAT_CIU');}if(tipo=='2'){f_oculta_div('div_UBM_EMP_ASEG');f_oculta_div('div_UBM_FUN_CI');f_muestra_div('div_UBM_REP_EXP_CIU');f_muestra_div('div_UBM_REP_CI_CIU');f_muestra_div('div_UBM_REP_PAT_CIU');f_muestra_div('div_UBM_REP_MAT_CIU');f_muestra_div('div_UBM_REP_NOM_CIU');f_muestra_div('divUBM_REP_CI_CIU');}if(tipo=='3'){f_oculta_div('div_UBM_FUN_CI');f_muestra_div('div_UBM_EMP_ASEG');f_oculta_div('div_UBM_REP_PAT_CIU');f_oculta_div('div_UBM_REP_MAT_CIU');f_oculta_div('div_UBM_REP_NOM_CIU');f_oculta_div('div_UBM_REP_CI_CIU');f_oculta_div('div_UBM_REP_EXP_CIU');}" id="UBM_REP_REPOSITOR" name="registro[]" class="form-control" ng-model="datos.UBM_REP_REPOSITOR">
                    <option value="-1"> -- Seleccione -- </option>
                    <option value="1">Funcionario</option>
                    <option value="2">Ciudadano</option>
                    <option value="3">Empresa Asegurada</option>
                  </select>
                  <input type="hidden" placeholder="El Repositor es" class="form-control" id="UBM_REP_REPOSITOR_VALOR" name="registro[]" value="Ciudadano" ng-model="datos.UBM_REP_REPOSITOR_VALOR">
                </div>
              </div>
            </div>
            <div id="div_UBM_EMP_ASEG" name="componentes" style="display: none;">
              <div class="form-group">
                <label class="col-sm-2 control-label">Empresa Asegurada:</label>
                <div class="col-sm-10">
                  <input type="text" placeholder="Empresa Asegurada" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_EMP_ASEG" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_EMP_ASEG">
                </div>
              </div>
            </div>
            <div id="div_UBM_FUN_CI" name="componentes" style="display: none;">
              <div class="form-group">
                <label class="col-sm-2 control-label">CI FUNCIONARIO:</label>
                <div class="col-sm-10">
                  <input type="number" placeholder="CI" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_FUN_CI" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_FUN_CI">
                </div>
              </div>
            </div>
            <div id="div_UBM_REP_PAT_CIU" name="componentes" style="display: block;">
              <div class="form-group"><label class="col-sm-2 control-label">Apellido Paterno:</label>
                <div class="col-sm-10">
                  <input type="text" placeholder="Apellido Paterno" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_REP_PAT_CIU" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_PAT_CIU">
                </div>
              </div>
            </div>
            <div id="div_UBM_REP_MAT_CIU" name="componentes" style="display: block;">
              <div class="form-group">
                <label class="col-sm-2 control-label">Apellido Materno:</label>
                <div class="col-sm-10">
                  <input type="text" placeholder="Apellido Materno" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_REP_MAT_CIU" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_MAT_CIU">
                </div>
              </div>
            </div>
            <div id="div_UBM_REP_NOM_CIU" name="componentes" style="display: block;">
              <div class="form-group">
                <label class="col-sm-2 control-label">Nombres:</label>
                <div class="col-sm-10">
                  <input type="text" placeholder="Nombres" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_REP_NOM_CIU" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_NOM_CIU">
                </div>
              </div>
            </div>
            <div id="div_UBM_REP_CI_CIU" name="componentes" style="display: block;">
              <div class="form-group">
                <label class="col-sm-2 control-label">CI:</label>
                <div class="col-sm-10">
                  <input type="number" placeholder="CI" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_REP_CI_CIU" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_CI_CIU">
                </div>
              </div>
            </div>
            <div id="div_UBM_REP_EXP_CIU" name="componentes" style="display: block;">
              <div class="form-group">
                <label class="col-sm-2 control-label">Expedido:</label>
                <div class="col-sm-10">
                  <select id="UBM_REP_EXP_CIU" name="registro[]" class="form-control" ng-model="datos.UBM_REP_EXP_CIU" onchange="f_obtener_texto('UBM_REP_EXP_CIU')">
                    <option value="-1"> -- Seleccione -- </option>
                    <option value="1">LA PAZ</option>
                    <option value="2">SANTA CRUZ</option>
                    <option value="3">TARIJA</option>
                    <option value="4">CHUQUISACA</option>
                    <option value="5">COCHABAMBA</option>
                    <option value="6">ORURO</option>
                    <option value="7">POTOSI</option>
                    <option value="8">BENI</option>
                    <option value="9">PANDO</option>
                  </select>
                  <input type="hidden" placeholder="Expedido" class="form-control" id="UBM_REP_EXP_CIU_VALOR" name="registro[]" value="BENI" ng-model="datos.UBM_REP_EXP_CIU_VALOR">
                </div>
              </div>
            </div>
            <div id="div_UBM_REP_BUSQUEDA" name="componentes">
              <div class="col-sm-20" align="center">
                <br>
                <br>
                <span> Nota: Para la búsqueda de un Funcionario, debe introducir en el siguiente campo un dato para identificar al funcionario. Por ej. Apellido Paterno </span>
                <br>
                <br>
              </div>
            </div>
            <div id="div_UBM_REP_BUSQUEDA" name="componentes">
              <div class="form-group">
                <label class="col-sm-2 control-label">Búsqueda Funcionario:</label>
                <div class="col-sm-10">
                  <!--input onblur="valores = f_obtener_valor('UBM_REP_BUSQUEDA'); console.log('valores'.valores); sql = 'SELECT dag.dag_ubm_funcionarios.fun_id as valor, upper(CONCAT(_bp_personas.prs_nombres,&amp; &amp; ,_bp_personas.prs_paterno,&amp; &amp;,_bp_personas.prs_materno))as dato, dag.dag_ubm_funcionarios.fun_prs_id as prs_f, _bp_personas.prs_id as prs FROM dag.dag_ubm_funcionarios INNER JOIN _bp_personas ON dag.dag_ubm_funcionarios.fun_prs_id  = _bp_personas.prs_id AND upper(_bp_personas.prs_paterno ) like (&amp;%' + valores + '%&amp;)'; angular.element(document.getElementById('renderFormulario')).scope().datosComboRender('UBM_FUNCIONARIO_SELECCIONADO',sql); $('#UBM_FUNCIONARIO_SELECCIONADO').val(valores);" type="text" placeholder="Búsqueda Funcionario" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_REP_BUSQUEDA" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_BUSQUEDA"-->
                  <input type="text" ng-change="funcionarios_resp(datos.UBM_REP_BUSQUEDA)" placeholder="Búsqueda Funcionario" class="form-control" id="UBM_REP_BUSQUEDA" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_BUSQUEDA">
                </div>
              </div>
            </div>
            <div id="div_UBM_FUNCIONARIO_SELECCIONADO" name="componentes">
              <div class="form-group">
                <label class="col-sm-2 control-label">Funcionario:</label>
                <div class="col-sm-10">
                  <select ng-model="datos.UBM_FUNCIONARIO_SELECCIONADO"  ng-change="activos_asig(datos.UBM_FUNCIONARIO_SELECCIONADO)" name="UBM_FUNCIONARIO_SELECCIONADO" id="UBM_FUNCIONARIO_SELECCIONADO" class="form-control" ng-disabled="desabilitado" ng-required="true">
                      <option ng-repeat="resp_f in funcionarioc"  value="{{resp_f.dag_ubm_fr_ci}}">{{resp_f.nombre.f1}} {{resp_f.nombre.f2}} {{resp_f.nombre.f3}}</option>
                  </select>

                  <input type="hidden" placeholder="Funcionario" class="form-control" id="UBM_FUNCIONARIO_SELECCIONADO_VALOR" name="registro[]" value="-- Seleccione --" ng-model="datos.UBM_FUNCIONARIO_SELECCIONADO_VALOR">
                </div>
              </div>
            </div>


            <!--div id="div_UBM_REP_TIENE_SEGURO" name="componentes">
              <div class="form-group">
                <label class="col-sm-6 control-label">Activo Incluye Seguro:</label>
                <div class="col-sm-6">
                  <input type="checkbox" class="form-control" id="UBM_REP_TIENE_SEGURO" name="registro[]" value="" ng-model="datos.UBM_REP_TIENE_SEGURO">
                </div>
              </div>
            </div>
            <div class="ibox-title_2" id="div_UBM_REP_T_DATOS_ACTIVO">
              <h5>Datos del Activo a Reponer:</h5>
            </div>
            <div id="div_UBM_REP_COD_ACTIVO" name="componentes">
              <div class="form-group">
                <label class="col-sm-2 control-label">Código de Activo a Reponer:</label>
                <div class="col-sm-10">
                  <input type="text" placeholder="Código de Activo a Reponer" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_REP_COD_ACTIVO" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_REP_COD_ACTIVO">
                </div>
              </div>
            </div-->
            <br>
            <div id="div_UBM_FUNCIONARIO_SELECCIONADO">
              <div class="form-group">
                <label class="col-sm-2 control-label">Datos de Activo Asignado:</label>
                <div class="col-sm-10">
                  <select ng-model="datos.UBM_ACTIVOS_ASIGNADAS"  name="UBM_ACTIVOS_ASIGNADAS" id="UBM_ACTIVOS_ASIGNADAS" class="form-control" ng-disabled="desabilitado" ng-required="true" ng-change="description_act(datos.UBM_ACTIVOS_ASIGNADAS)">
                      <option ng-repeat="resp_f in response2"  value="{{resp_f.codigoaf}}">{{resp_f.codigoaf}} - {{resp_f.tipoactivo}}</option>
                  </select>

                  <input type="hidden" placeholder="Funcionario" class="form-control" id="UBM_FUNCIONARIO_SELECCIONADO_VALOR" name="registro[]" value="-- Seleccione --" ng-model="datos.UBM_FUNCIONARIO_SELECCIONADO_VALOR">
                </div>
              </div>
            </div>

            <div class="form-group">
              <label class="col-sm-2 control-label">Características del Activo:</label>
              <div class="col-sm-10">
                
              </div>
            </div>

            
            <div id="div_UBM_REP_CARACTERISTICAS_ACTIVO" name="componentes" ng-repeat="car_act in carac">
              
              <div class="form-group">
                <label class="col-sm-2 control-label"></label>
                <div class="col-sm-10">
                  <input cols="45" rows="5" placeholder="Características del Activo" class="form-control" id="UBM_REP_CARACTERISTICAS_ACTIVO" name="registro[]" ng-model="datos.UBM_REP_CARACTERISTICAS_ACTIVO" value="{{car_act.name}}  -  {{car_act.value}}" readonly="readonly"/>
                </div>
              </div>
            </div>
            <br><br>
            
            

            
            <div class="form-group">
              <label class="col-sm-2 control-label">Tecnico:</label>
              <div class="col-sm-10">
                <select id="UBM_TEC_ESP" name="registro[]" class="form-control" ng-model="datos.UBM_TEC_ESP" ng-change="tecnicoesp(datos.UBM_TEC_ESP)">
                  <option value="1">SI</option>
                  <option value="2">NO</option>
                </select>
                <input type="hidden" placeholder="Expedido" class="form-control" id="UBM_TEC_ESP_VALOR" name="registro[]" ng-model="datos.UBM_TEC_ESP_VALOR">
              </div>
            </div>

            <div class="form-group" ng-show="mostar">
              <label class="col-sm-2 control-label">Tecnico Especializado:</label>
              <div class="col-sm-10">
                <input type="text" placeholder="Tecnico Especializado" class="form-control ng-dirty ng-invalid ng-invalid-required" ng-disabled="only" id="UBM_TECNICO_ESP" name="registro[]" onkeyup="return conMayusculas(this)" value="" ng-model="datos.UBM_TECNICO_ESP">
              </div>
            </div>
            <br><br>
            
            <div class="ibox-title_2" id="div_UBM_REP_T_DATOS_ACTIVO_REPUESTO">
              <h5>Ubicacion Unidad Organizacional:</h5>
            </div>
            <div class="form-group"><label class="col-sm-2 control-label">Sector:</label>
            <div class="col-sm-10">
                    <select class="form-control" id="selSector" name="selSector" ng-model="datos.Sec_Sel" ng-options="datoS.dag_s_s as (datoS.dag_s_s + ' ' + datoS.dag_s_descripcion) for datoS in datosSector" ng-change="getDA(datos.Sec_Sel)">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="form-group"><label class="col-sm-2 control-label">Direccion Administrativa:</label>
                <div class="col-sm-10">
                    <select class="form-control" id="selDA" name="selDA" ng-model="datos.DA_Sel" ng-options="datoDA.dag_da_da as (datoDA.dag_da_da + ' ' + datoDA.dag_da_descripcion) for datoDA in datosDirAdm | filter:{dag_da_s:Sec_Sel}:true" ng-change="getUE(datos.DA_Sel)">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="form-group"><label class="col-sm-2 control-label">Unidad Ejecutora:</label>
                <div class="col-sm-10">
                    <select class="form-control" id="selUE" name="selUE" ng-model="datos.UE_Sel" ng-options="datoUE.dag_ue_ue as (datoUE.dag_ue_ue + ' ' + datoUE.dag_ue_descripcion) for datoUE in datosUniEje | filter:{dag_ue_s:Sec_Sel,dag_ue_da:DA_Sel}:true" ng-change="getUO(datos.UE_Sel)">
                        <option value=""></option>
                    </select>
                </div>
            </div>
            <div class="form-group"><label class="col-sm-2 control-label">Unidad Organizacional:</label>
                <div class="col-sm-10">
                    <select class="form-control" id="selUO" name="selUO" ng-model="datos.UO_Sel" ng-options="datoUE.dag_uo_uo as (datoUE.dag_uo_uo + ' ' + datoUE.dag_uo_descripcion) for datoUE in datosUniOrg | filter:{dag_uo_s:Sec_Sel,dag_uo_da:DA_Sel,dag_uo_ue:UE_Sel}:true">
                        <option value=""></option>
                    </select>
                </div>
            </div>




            <div class="ibox-title_2" id="div_UBM_REP_T_DATOS_ACTIVO_REPUESTO">
              <h5>Datos del Activo Repuesto:</h5>
            </div>




          <div class="hr-line-dashed"></div>

          <div class="form-group">
            <label class="col-sm-2 control-label"></label>

               <div class="col-sm-10">

                  <!--input class="btn btn-primary" ng-click="probarCodificacion()" type="button" value="Generar Codificacion" /-->
               </div>
          </div>

          <div class="form-group">
              <label class="col-sm-2 control-label"></label>
              <div class="col-sm-10">
                <input class="btn btn-primary" ng-click="limpiarFormRegistro()" type="button" value="NUEVA FILA" data-toggle="modal"  data-target="#fo"/>
                <!--input class="btn btn-primary" ng-click="recargar()" type="button" value="RECARGAR"/-->


              </div>
          </div>

          <div class="hr-line-dashed"></div>

          <div class="ibox-content">
            <div class="col-sm-12">
              <div class="table-responsive">
                <table ng-table="tablaUsuarios" show-filter="true" class="table table-striped table-hover">
                    <tr ng-repeat="item in items1">
                            <td data-title="'Opciones'">
                              <a tooltip = "Editar" ng-click="idd(item.id)" data-toggle="modal" data-target="#fo" class="btn btn-default btn-circle">
                                <i class="fa fa-pencil"></i>
                              </a>
                              <a tooltip = "Eliminar" ng-click="del(item.id)" class="btn btn-default btn-circle">
                                  <i class="fa fa-trash-o"></i>
                              </a>
                            </td>
                            <td data-title="'#'">{{item.id}}</td>
                            <td data-title="'Partida'" sortable="'campo'" filter="{'campo':'text'}">{{item.campo}}</td>
                            <td data-title="'Activo'" sortable="'activo'" filter="{'activo':'text'}">{{item.activo}}</td>



                            <td data-title="'Valor'" sortable="'valor'" filter="{'valor':'text'}">{{item.valor}}</td>
                            <td data-title="'Responsable'" sortable="'responsable'" filter="{'responsable':'text'}">{{item.responsable}}</td>

                            <td data-title="'Cantidad'" sortable="'cantidad'" filter="{'cantidad':'text'}">{{item.cantidad}}</td>

                            <!--td data-title="'Codificacion'" sortable="'codificacion'" filter="{'codificacion':'text'}">{{item.codificacion}}</td-->



                            <td data-title="'Descripcion'" sortable="'value'" filter="{'tarea_caracterist2':'text'}" >
                              <table>
                                <tr ng-repeat="car in item.tarea_caracterist2">
                                  <td>{{car.name}}:</td>
                                  <td>{{car.value}}</td>
                                </tr>
                              </table>
                            </td>
                            <td><a class="glyphicon glyphicon-eye-open" ng-click="fotos(item.id)" data-toggle="modal"  data-target="#fotos"></a>
                            </td>




                    </tr>
                </table>
                 <textarea id="tarea_caracterist" style="visibility:hidden" name="tarea_caracterist" ng-model="datos.tarea_caracterist" class="form-control" onkeyUp="return conMayusculas(this);"></textarea>
              </div>
            </div>
          </div>
          
          <div class="form-group" ng-show="btnmostrar2">
              <label class="col-sm-2 control-label">Codigo Generado</label>
              <div class="col-sm-10">
                  <input name="gen" id="gen" ng-model="datos.gen"/>
              </div>
          </div>

          <button ng-show="btnmostrar"  type="button" class="btn btn-primary" ng-click="verificarDatos(datos)"> <i class="glyphicon fa fa-save"></i> Generar codigo </button>

          <div class="modal fade" id="fotos" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" ng-show="modal=='new'" ng-hide="modal=='upd'">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                  <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
                      <h4 class="modal-title" id="myModalLabel">Imagenes</h4>
                  </div><br>

                  <div id="page">
                      <section>
                          <input type="radio" name="slider-select-element" id="element1" checked="checked" />
                          <input type="radio" name="slider-select-element" id="element2" />
                          <input type="radio" name="slider-select-element" id="element3" />

                          <div id="slider-container">
                              <div id="slider-box" ng-repeat="img in verfotos">
                                  <div class="slider-element">
                                      <img class="element" src='{{img.url_archivo}}' alt=''/>
                                  </div>

                              </div>
                          </div>

                          <div id="slider-arrows">
                              <label for="element1"></label>
                              <label for="element2"></label>
                              <label for="element3"></label>
                          </div>
                      </section>
                  </div><br><br><br><br><br><br><br>

                  <div class="modal-footer">
                      <button id="cerrar" name="cerrar" type="button"  class="btn btn-primary btn-inverse" data-dismiss="modal">Cerrar</button>
                  </div>
              </div>
            </div>
          </div>

          <div class="modal fade" id="fo" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog modal-lg">
              <div class="modal-content">
                  <div class="modal-header">
                      <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Cerrar</span></button>
                      <h4 class="modal-title" id="myModalLabel">Nuevo Dato</h4>
                  </div>
                  <div class="hr-line-dashed"></div>

                      <div class="form-group">
                        <label class="col-sm-2 control-label">Partida</label>
                        <div class="col-sm-9">
                            <select name="campo" id="campo" ng-model="caracteristica.campo" ng-click="caracteristicass(caracteristica.campo)" class="form-control" required>
                               <option style="display:none" value="">-- Seleccione --</option>
                               <option ng-repeat="rol in combop"  value="{{rol.codigo}}">{{rol.codigo}} - {{rol.nombre}}</option>
                            </select>
                            <span style="color:red" ng-show="formulario.campo.$invalid">
                              <span ng-show="formulario.campo.$error.required">La partida es requerida.</span>
                              </span>
                        </div>
                      </div>

                      <div class="form-group">
                        <div class="col-sm-2 control-label"><label for="text0">Tipo de Activo</label>
                        </div>
                        <div class="col-sm-9">
                          <select name="activo" id="activo" ng-model="caracteristica.activo" ng-change="descripcion(caracteristica.activo)" class="form-control">
                             <option style="display:none" value="">-- Seleccione --</option>
                             <option ng-repeat="com in data"  value="{{com.id}}">{{com.id}} - {{com.nombre}}</option>
                          </select>
                           <span style="color:red" ng-show="formulario.activo.$invalid">
                              <span ng-show="formulario.activo.$error.required">El activo es requerido.</span>
                              </span>
                        </div>
                      </div>

                      <div class="hr-line-dashed"></div>

                      <div class="form-group">
                        <div class="col-sm-2 control-label"><label for="text0"></label>
                        </div>
                        <div class="col-sm-9">
                            <label>CARACTERISTICAS: <small class="m-l-sm"></small></label>
                        </div>
                      </div>

                      <div class="form-group" ng-show="mostrar=='ok'" ng-hide="mostrar=='no'" ng-repeat="caracteristica in caracteristicas">
                          <label class="col-sm-2 control-label">{{caracteristica.name}}</label>
                          <div class="col-sm-9">
                              <input id="detalles" name="detalles" type="text" class="form-control" type="{{caracteristica.type}}" placeholder="" ng-model="caracteristica.value" ng-change="descCaractfn(caracteristicas)" required>
                               <span style="color:red" ng-show="formulario.detalles.$invalid">
                              <span ng-show="formulario.detalles.$error.required">Estos campos son requeridos.</span>
                              </span>
                              <br>
                          </div><br>

                      </div>
                      <textarea ng-model="caracteristica.tarea_caracterist2" ng-show="false" id="tarea_caracterist2" name="tarea_caracterist2" type="text" class="form-control">[]</textarea>

                      <div class="form-group">
                        <div class="col-sm-2 control-label"><label for="text0">Valor:</label>
                        </div>
                        <div class="col-sm-9"><input id="valor" name="valor" placeholder="Valor" ng-model="caracteristica.valor" class="form-control" type="number"  required>
                          <span style="color:red" ng-show="formulario.valor.$invalid">
                              <span ng-show="formulario.valor.$error.required">El valor es requerido.</span>
                              </span>
                        </div>
                      </div>

                      <div class="form-group">
                          <label class="col-sm-2 control-label" align="center">Responsable de Activo:</label>
                          <div class="col-sm-9">
                              <input type="text" id="responsable" name="responsable" ng-model="caracteristica.responsable" ng-change="cerear()" placeholder="Buscar Funcionario" class="form-control" required>
                              <span style="color:red" ng-show="formulario.responsable.$invalid">
                              <span ng-show="formulario.responsable.$error.required">El responsable es requerido.</span>
                              </span>
                              <br>
                                <ul style="border: 1px solid #009688;height:80px;  overflow-y:scroll;">
                                    <li ng-repeat="funcionario in ListFuncionarios | filter:caracteristica.responsable " ng-click="cambiafuncionario(funcionario.dag_ubm_fr_ci,funcionario.dag_ubm_fr_paterno,funcionario.dag_ubm_fr_materno,funcionario.dag_ubm_fr_nombres)">
                                        <a>{{funcionario.dag_ubm_fr_ci}} {{funcionario.dag_ubm_fr_paterno}} {{funcionario.dag_ubm_fr_materno}}, {{funcionario.dag_ubm_fr_nombres}}</a>
                                    </li>
                                </ul>
                          </div>
                      </div>

                      <div class="form-group">
                        <div class="col-sm-2 control-label"><label for="text0">Cantidad:</label>
                        </div>
                        <div class="col-sm-9"><input id="cantidad" name="cantidad" placeholder="Cantidad" ng-model="caracteristica.cantidad" class="form-control" type="text" onkeyUp="valNumericoValor(this);" required>
                          <span style="color:red" ng-show="formulario.cantidad.$invalid">
                              <span ng-show="formulario.cantidad.$error.required">La cantidad es requerida.</span>
                              </span>
                        </div>
                      </div>

                      <!--div class="form-group" ng-show="false">
                        <label class="col-sm-2 control-label">Codificación</label>
                        <div class="col-sm-9">
                            <input id="codificacion" name="codificacion" placeholder="codificacion" ng-model="caracteristica.codificacion" class="form-control" type="text">
                        </div>
                      </div-->
                      <div class="form-group" ng-show="false">
                        <label class="col-sm-2 control-label">ID</label>
                        <div class="col-sm-9">
                            <input id="id" name="id" placeholder="id" ng-model="caracteristica.id" class="form-control" type="text">
                        </div>
                      </div>

                      <textarea id="tarea_adjuntos" ng-show="false" name="tarea_adjuntos" ng-model="caracteristica.tarea_adjuntos" class="form-control" onkeyUp="return conMayusculas(this);">
                  </textarea>

                  <div class="col-md-12">
                            <legend>FOTOS: </legend>
                        </div>
                        <!-- DOCUMENTOS ADJUNTOS -->
                        <div class="col-md-12">
                            <div class="col-md-12">
                                <div class="form-group" >
                                    <label for="url"></label>
                                    <!-- DOCUMENTOS MULTIPLES -->
                                    <div class="col-md-12">
                                        <input type="hidden" name="datos.ARCHIVOS_MULTIPLES" id="datos.ARCHIVOS_MULTIPLES" ng-model="datos.ARCHIVOS_MULTIPLES"/>
                                    </div>
                                    <div class="col-md-12">
                                        <div class="form-group" >
                                            <div class="controls">
                                            <div class="col-md-7">
                                                <!--<label for="url" >Subir Archivo:</label>-->
                                                <input ng-mouseleave="pushItem1()" id="multiDocsFile" type="file" name= "files[0]" nv-file-select="" uploader="uploader" style="display: none;"/>
                                            </div>
                                                <!--<div class="col-md-12" style="border-style: ridge; border-color: #577C27;">-->
                                                <div class="col-md-12" style="{{adjuntoCssObligatorio}}">
                                                    <table class="table" ng-mouseleave="pushItem1()">
                                                        <thead>
                                                            <tr>
                                                                <th width="50%">Nombre</th>
                                                                <th ng-show="uploader.isHTML5">Tamaño(Mb)</th>
                                                                <th><center>Ver</center></th>
                                                                <th><button style="border: 1px solid #8C0E8A;" id="multiDocsButon" class="btn btn-success btn-xs"><span class="glyphicon glyphicon-upload"></span></button></th>
                                                            </tr>

                                                        </thead>
                                                        <tbody>
                                                            <!-- TRAMIES ALMACENADOS ACTUALMENTE -->
                                                            <tr ng-repeat="reg in datos.ARCHIVOS_MULTIPLES track by $index">
                                                                <td><strong>{{reg.nombre_archivo}}</strong></td>
                                                                <td><strong>{{reg.tam_archivo}}</strong></td>
                                                                <td><strong><center><!--a class="glyphicon glyphicon-eye-open" target="_blank" href="{{reg.url_archivo}}" ></a--></center></strong></td>
                                                                <td><button ng-click="eliminarMultipleAdjunto($index)" id="multiDocsBtnEliminar" class="btn btn-success btn-xs"><span class="glyphicon glyphicon-remove"></span></button></td>
                                                            </tr>

                                                            <tr ng-repeat="registro in uploader.queue ">
                                                                <td><strong>{{registro.file.name }}</strong></td>
                                                                <td ng-show="uploader.isHTML5" nowrap>{{ registro.file.size/1024/1024|number:2 }} MB</td>
                                                                <td class="text-center">
                                                                    <span ng-show="registro.isSuccess"><i class="glyphicon glyphicon-ok"></i></span>
                                                                    <span ng-show="registro.isError"><i class="glyphicon glyphicon-remove"></i></span>
                                                                </td>
                                                                <td nowrap>
                                                                <button ng-show="botonSubirOriginal == null"  type="button" class="btn btn-success btn-xs" ng-click="registro.upload();" ng-disabled="registro.isReady || registro.isUploading || registro.isSuccess ">
                                                                    <span class="glyphicon glyphicon-upload"></span> Subir
                                                                </button>
                                                                <button ng-show="botonSubirError == null" type="button" class="btn btn-success btn-xs" ng-click="falla();" ng-disabled="registro.isReady || registro.isUploading">
                                                                    <span class="glyphicon glyphicon-upload"></span> Subir
                                                                </button>
                                                                <button type="button" class="btn btn-danger btn-xs" ng-click="registro.remove()">
                                                                    <span class="glyphicon glyphicon-trash"></span> Eliminar
                                                                </button>
                                                                </td>
                                                            </tr>
                                                        </tbody>
                                                    </table>
                                                </div>
                                                <br>
                                                <br>
                                            </div>
                                        </div>
                                    </div>
                                    <!-- DOCUMENTOS MULTIPLES -->
                                </div>
                            </div>
                        </div>


                  <div class="modal-footer">
                      <button id="cerrar" name="cerrar" type="button" class="btn btn-primary btn-inverse" data-dismiss="modal">Cerrar</button>
                      <button ng-click="editargrid(caracteristica);" type="button" class="btn btn-primary" data-dismiss="modal" ng-show="boton=='upd'" ng-hide="boton=='new'">Modificar</button>
                      <button ng-click="guardargrid(caracteristica);" type="button" class="btn btn-primary" data-dismiss="modal" ng-show="boton=='new'" ng-hide="boton=='upd'" ng-disabled="formulario.campo.$invalid || formulario.detalles.$invalid || formulario.valor.$invalid || formulario.responsable.$invalid || formulario.cantidad.$invalid || formulario.tarea_caracterist2.$invalid">Guardar</button>
                      <!--button ng-click="editargrid(caracteristica);" type="button" class="btn btn-primary" data-dismiss="modal" ng-show="boton=='upd'" ng-hide="boton=='new'">Modificar</button-->
                  </div>
              </div>
            </div>
          </div>


          <div class="hr-line-dashed"></div>
          <button type="button" class="btn btn-primary" ng-disabled="false" ng-click="volver()"> <i class="glyphicon fa fa-times"></i> Cancelar </button>
          <button type="button" class="btn btn-primary" ng-click="guardarItem(datos)"> <i class="glyphicon fa fa-save"></i> Guardar / Continuar </button>
        </div>
      </form>
  </div>
